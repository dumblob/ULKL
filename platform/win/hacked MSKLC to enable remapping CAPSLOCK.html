<!DOCTYPE html>
<html xml:lang="en" lang="en" dir="ltr" class="no-js">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1">
		
				
		<title>&#039;hacked&#039; MSKLC to enable remapping CAPSLOCK - User contributions - Colemak forum</title>
		<link href="https://forum.colemak.com/style/pantherone.css" rel="stylesheet" />
		<link href="https://forum.colemak.com/style/core/normalize.css" rel="stylesheet" />
		
		<script>
			document.documentElement.className = 
			document.documentElement.className.replace("no-js","js");
		</script>

				<link rel="stylesheet" href="https://forum.colemak.com/style/core/editor.css" />
		
		<!--		<link href="https://forum.colemak.com/assets/js/square.min.css" rel="stylesheet" />
		-->
		
		<!---->

				<link href="https://forum.colemak.com/style/pantherone/themes/default_blue.css" rel="stylesheet" />
		
		<script src="https://forum.colemak.com/assets/js/jquery-2.2.4.min.js"></script>
		<script type="text/javascript">var url = new Array("https://forum.colemak.com/", "https://forum.colemak.com:/assets/images/smilies/", "https://forum.colemak.com/assets/js/");</script>
		
				<script src="https://forum.colemak.com/assets/js/reputation.js"></script>
				
		<!--		<script src="https://forum.colemak.com/assets/js/bbcode.js"></script>
		<script src="https://forum.colemak.com/assets/js/sceditor.js"></script>
		-->
		
				<script src="https://forum.colemak.com/assets/js/jquery.wysibb.js"></script>
		
<!-- Init WysiBB BBCode editor -->

				<script type="text/javascript">
		$(document).ready(function()
		{
			var wbbOpt = {
				buttons: "bold,italic,strike,|,smilebox,img,link,|,bullist,numlist,|,fontcolor,|,quote,code,spoiler,smileList,|,removeFormat",
				onlyBBmode: true,			}
			$(".txteditor").wysibb(wbbOpt);
		});
		</script>
		

				
				
		
		<link href="https://forum.colemak.com/assets/images/favicon.ico" type="image/x-icon" rel="shortcut icon" />
                		<link rel="stylesheet" href="/assets/fonts/fonts.css" />
		<link rel="stylesheet" href="/assets/fonts/font-awesome.min.css" />
		<style type="text/css">.gid1 {color: #AA0000; font-weight: bold; font-style: italic} .gid2 {color: #0000CC; font-weight: bold; font-style: italic} .gid3 {color: #00AA00; font-weight: bold} .gid4 {font-weight: bold} .gid5 {font-weight: bold} </style>

						<link href="https://forum.colemak.com/topic/870-hacked-msklc-to-enable-remapping-capslock/" rel="canonical" />
				<link href="https://forum.colemak.com/feed/atom/tid/870.xml" rel="alternate" type="application/atom+xml" title="Atom topic feed" />
				
<script type="text/javascript">
$(document).ready(function(){

  $('div.block').each(function() {
    var $dropdown = $(this);

    $(".openclose", $dropdown).click(function(e) {
      e.preventDefault();
      $($dropdown).toggleClass('close');
      return false;
    });

});
    
  //$('html').click(function(){
   // $($dropdown).hide();
  //});
     
});

</script>
	</head>
	
		<body>
			<div id="pantherviewtopic" class="panther">


		
		<header id="brdheader" class="brd-header">
			<div id="brdtitle" class="brd-branding">
									<h1><a href="https://forum.colemak.com/">Colemak forum</a></h1>
								<div id="brddesc">Forum for the <a href="https://colemak.com/">Colemak keyboard layout</a>.</div>
			</div>
				
			<div id="brdmenu" class="brd-menu">
				<div class="wrapper">
				    <input type="checkbox" name="togglemenu" id="togglemenu" />
				    <label for="togglemenu" class="togglemenu"></label>
				    <!--<button id="togglemenu" class="btn"><span class="text">Collapse the menu</span></button>-->
				    <ul class="pmenu">
					    					    <li id="navindex" class="isactive"><a href="https://forum.colemak.com/"><span class="text">Index</span></a></li>
					    					    <li id="navuserlist"><a href="https://forum.colemak.com/userlist/"><span class="text">User list</span></a></li>
					    					    <li id="navleaders"><a href="https://forum.colemak.com/the-moderating-team/"><span class="text">The Moderating Team</span></a></li>
					    					    <li id="navsearch"><a href="https://forum.colemak.com/search/"><span class="text">Search</span></a></li>
					    					    <li id="navregister"><a href="https://forum.colemak.com/register/"><span class="text">Register</span></a></li>
					    					    <li id="navlogin"><a href="https://forum.colemak.com/login/"><span class="text">Login</span></a></li>
					    					</ul>
				</div>
			</div>

		<div id="brdwelcome" class="brd-welcome">
		
		    <div class="wrapper">
			    <ul class="info">
								    <li class="notlogged">You are not logged in.</li>
				    			    </ul>
			    			    <ul class="topics">
				    <li>Topics:</li>
				    <li class="mytopics">
				    	<a href="https://forum.colemak.com/show-recent/" title="Find topics with recent posts.">Active</a>
				    					    </li><li class="mytopics">
				    	<a href="https://forum.colemak.com/show-unanswered/" title="Find topics with no replies.">Unanswered</a>
				    					    </li>			    </ul>
			    		    </div>
		</div>	
		
				
		</header>
		
				
		<div id="brdmain" class="brd-main">
			<div class="wrapper">
<div class="linkst">
    <ul vocab="http://schema.org/" typeof="BreadcrumbList" class="crumbs">
		<li property="itemListElement" typeof="ListItem">
			<a property="item" typeof="WebPage" href="https://forum.colemak.com/"><span property="name">Index</span></a>
			<meta property="position" content="1">
		</li>
  
			
		<span class="separator">›</span>
		<li property="itemListElement" typeof="ListItem">
			<a property="item" typeof="WebPage" href="https://forum.colemak.com/forum/10-user-contributions/"><span property="name">User contributions</span></a>
			<meta property="position" content="2">
		</li>
	
		<span class="separator">›</span>
		<li property="itemListElement" typeof="ListItem">
			<span property="item" typeof="WebPage"><span property="name">&#039;hacked&#039; MSKLC to enable remapping CAPSLOCK</span></span>
			<meta property="position" content="3">
		</li>
	</ul>
	<div class="pagepost">
		<ul class="pagination"></ul>
		<div class="postlink">
																	</div>
	</div>
</div>

<div class="topic-title">
    <h1>&#039;hacked&#039; MSKLC to enable remapping CAPSLOCK</h1>
	<ul>
        <li>Started by screaminglemon</li>
        <li>24 Replies:</li>
    </ul>
</div>


<div id="p6416" class="block bpost rowodd firstpost blockpost1">
	<div class="post-body">
		<div class="postprofile">	    
						<span class="postavatar offline"><span class="image status offline"><img src="https://forum.colemak.com/assets/images/avatars/1.jpg?m=1453462472" width="150" height="150" alt="" /></span></span>
				
			<ul class="usercard">
			    <li class="username"><a href="https://forum.colemak.com/user/605-screaminglemon/"><span class="gid5">screaminglemon</span></a></li>
				<li class="usertitle"><span class="thegroup">Member</span></li>
							</ul>
			<ul class="userinfos">
								<li class="reputation positive">Reputation: 1</li>
						
			    				<li>Registered: 15-Feb-2010</li>
								<li>Posts: 14</li>
							</ul>		
						<ul class="usercontact">
								<li class="website"><a href="http://www.tinkerwithabandon.com/twa/keyboarding.html" rel="nofollow">Website</a></li>
							</ul>
		    		</div>
	
		<div class="postcontent">
			<div class="postinfo">
			    <span class="conl"><a href="https://forum.colemak.com/post/6416/#p6416">22-Apr-2010 02:23:23</a></span><span class="conr">#1</span>
			    <span class="small-topictitle">&#039;hacked&#039; MSKLC to enable remapping CAPSLOCK</span>
			</div>
			<div class="postmsg">
				<p>Well not exactly hacked per se, but I found you can manually edit one of the MSKLC source files to remap CAPSLOCK, and I assume any key for that matter.&#160; And please forgive me if this is old news for I searched and could not find this info anywhere.</p><p><strong>Mandatory stupid warning:</strong>&#160; I assume no responsibility if this FUBARs your computer.&#160; I have tested it on mine (Win7 32 and 64 bit) and it seems to work fine but <strong>use at your own risk.</strong></p><br /><p>Instructions:</p><p>(1) Download and install Microsoft keyboard Layout Creator 1.4 (MSKLC) from Microsofts website.</p><p>(2) Copy a backup of the file C:\Program Files\Microsoft Keyboard Layout Creator 1.4\inc\kbd.h<br />&#160; &#160; &#160; In 64bit windows its: C:\Program Files (x86)\Microsoft Keyboard Layout Creator 1.4\inc\kbd.h</p><p>&#160; &#160; &#160;Keep this backup in a safe place so you can easily restore the file if need be.</p><p>(3) Open (EDIT) kbd.h in notepad.&#160; Scroll down till you see the keyboard type 4 definitions.<br />&#160; &#160; &#160;Should look like this:</p><div class="codebox"><pre class="vscroll"><code>#if (KBD_TYPE &lt;= 6)
/***************************************************************************\
* T** - Values for ausVK[] (Virtual Scan Code to Virtual Key conversion)
*
* These values are for Scancode Set 3 and the USA.
* Other languages substitute their own values where required (files kbd**.h)
*
* Six sets of keyboards are supported, according to KBD_TYPE:
*
* KBD_TYPE   Keyboard (examples)
* ========   =======================================================
*    1       AT&amp;T &#039;301&#039; &amp; &#039;302&#039;; Olivetti 83-key; PC-XT 84-key; etc.
*    2       Olivetti M24 102-key
*    3       HP Vectra (DIN); Olivetti 86-key; etc.
*    4 *     Enhanced 101/102-key; Olivetti A; etc.
*    5       Nokia (Ericsson) type 5 (1050, etc.)
*    6       Nokia (Ericsson) type 6 (9140)
*
* * If KBD_TYPE is not defined, the default is type 4.
*
* KB3270 comments refers to KB 3270 keyboards in native emulation mode (DIP
* switches all OFF), and the Scancode Map used to convert its scancodes to
* standard scancode set 1.
*    KB3270 &lt;= 57      - this entry is reached by mapping from scancode 0x57
*                        to an arbitrary scancode: the VK is what counts
*    KB3270 =&gt; HOME    - this scancode is mapped to the scancode for VK_HOME
*    KB3270            - no mapping involved, a scancode for KB3270 only
*
* _EQ() : all keyboard types have the same virtual key for this scancode
* _NE() : different virtual keys for this scancode, depending on kbd type
*
*     +------+ +--------+--------+--------+--------+--------+--------+
*     | Scan | |  kbd   |  kbd   |  kbd   |  kbd   |  kbd   |  kbd   |
*     | code | | type 1 | type 2 | type 3 | type 4 | type 5 | type 6 |
\****+-------+-+--------+--------+--------+--------+--------+--------+******/
#define T00 _EQ(                           _none_                    )
#define T01 _EQ(                           ESCAPE                    )
#define T02 _EQ(                           &#039;1&#039;                       )
#define T03 _EQ(                           &#039;2&#039;                       )
#define T04 _EQ(                           &#039;3&#039;                       )
#define T05 _EQ(                           &#039;4&#039;                       )
#define T06 _EQ(                           &#039;5&#039;                       )
#define T07 _EQ(                           &#039;6&#039;                       )
#define T08 _EQ(                           &#039;7&#039;                       )
#define T09 _EQ(                           &#039;8&#039;                       )
#define T0A _EQ(                           &#039;9&#039;                       )
#define T0B _EQ(                           &#039;0&#039;                       )
#define T0C _EQ(                           OEM_MINUS                 )
#define T0D _NE(OEM_PLUS,OEM_4,   OEM_PLUS,OEM_PLUS,OEM_PLUS,OEM_PLUS)
#define T0E _EQ(                           BACK                      )
#define T0F _EQ(                           TAB                       )
#define T10 _EQ(                           &#039;Q&#039;                       )
#define T11 _EQ(                           &#039;W&#039;                       )
#define T12 _EQ(                           &#039;E&#039;                       )
#define T13 _EQ(                           &#039;R&#039;                       )
#define T14 _EQ(                           &#039;T&#039;                       )
#define T15 _EQ(                           &#039;Y&#039;                       )
#define T16 _EQ(                           &#039;U&#039;                       )
#define T17 _EQ(                           &#039;I&#039;                       )
#define T18 _EQ(                           &#039;O&#039;                       )
#define T19 _EQ(                           &#039;P&#039;                       )
#define T1A _NE(OEM_4,   OEM_6,   OEM_4,   OEM_4,   OEM_4,   OEM_4   )
#define T1B _NE(OEM_6,   OEM_1,   OEM_6,   OEM_6,   OEM_6,   OEM_6   )
#define T1C _EQ(                           RETURN                    )
#define T1D _EQ(                           LCONTROL                  )
#define T1E _EQ(                           &#039;A&#039;                       )
#define T1F _EQ(                           &#039;S&#039;                       )
#define T20 _EQ(                           &#039;D&#039;                       )
#define T21 _EQ(                           &#039;F&#039;                       )
#define T22 _EQ(                           &#039;G&#039;                       )
#define T23 _EQ(                           &#039;H&#039;                       )
#define T24 _EQ(                           &#039;J&#039;                       )
#define T25 _EQ(                           &#039;K&#039;                       )
#define T26 _EQ(                           &#039;L&#039;                       )
#define T27 _NE(OEM_1,   OEM_PLUS,OEM_1,   OEM_1,   OEM_1,   OEM_1   )
#define T28 _NE(OEM_7,   OEM_3,   OEM_7,   OEM_7,   OEM_3,   OEM_3   )
#define T29 _NE(OEM_3,   OEM_7,   OEM_3,   OEM_3,   OEM_7,   OEM_7   )
#define T2A _EQ(                           LSHIFT                    )
#define T2B _EQ(                           OEM_5                     )
#define T2C _EQ(                           &#039;Z&#039;                       )
#define T2D _EQ(                           &#039;X&#039;                       )
#define T2E _EQ(                           &#039;C&#039;                       )
#define T2F _EQ(                           &#039;V&#039;                       )
#define T30 _EQ(                           &#039;B&#039;                       )
#define T31 _EQ(                           &#039;N&#039;                       )
#define T32 _EQ(                           &#039;M&#039;                       )
#define T33 _EQ(                           OEM_COMMA                 )
#define T34 _EQ(                           OEM_PERIOD                )
#define T35 _EQ(                           OEM_2                     )
#define T36 _EQ(                           RSHIFT                    )
#define T37 _EQ(                           MULTIPLY                  )
#define T38 _EQ(                           LMENU                     )
#define T39 _EQ(                           &#039; &#039;                       )
#define T3A _EQ(                           CAPITAL                   )
#define T3B _EQ(                           F1                        )
#define T3C _EQ(                           F2                        )
#define T3D _EQ(                           F3                        )
#define T3E _EQ(                           F4                        )
#define T3F _EQ(                           F5                        )</code></pre></div><p>Now replace where it says &quot;CAPTITAL&quot; with &quot;BACK&quot;.</p><p>Save the file.&#160; And now &#039;copy and replace&#039; it back into the %MSKLC%\inc directory so MSKLC will now use the new definition when it runs.</p><p>(4) Run MSKLC as you normally would.&#160; Create or import a layout and then &quot;build DLL and Setup Package&quot;.</p><p>Viola!&#160; The resulting *.DLL files will have the remapped CAPSLOCK.&#160; No need to mess with registry, and you don&#039;t need to reboot to get the original QWERTY + CAPSLOCK behavior back.&#160; Just change to a normal layout with the language bar.</p><p>You can also put CAPSLOCK on the BACKSPACE key and swap LSHIFT/RSHIFT with letter keys.&#160; That is all I have tested so far and it all seems to work fine.</p>
						
										
							</div>
						<div class="postsign"><p><a href="http://www.tinkerwithabandon.com/twa/keyboarding.html" rel="nofollow">http://www.tinkerwithabandon.com/twa/keyboarding.html</a></p></div>
					</div>		
	</div>
	<div class="post-foot">
		<div class="postfootleft"><span class="offline">Offline</span></div>	
				<div class="postfootright">
			<ul class="postactions">	
								<li class="postrep">
					<span  id="post_rep_6416" class="reputation positive">
						<span class="title">1</span>											</span>
				</li>
							</ul>
		</div>			
				
	</div>
</div>
<div id="p6421" class="block bpost roweven">
	<div class="post-body">
		<div class="postprofile">	    
						<span class="postavatar offline"><span class="image status offline"><img src="https://forum.colemak.com/assets/images/avatars/1.jpg?m=1453462472" width="150" height="150" alt="" /></span></span>
				
			<ul class="usercard">
			    <li class="username"><a href="https://forum.colemak.com/user/497-spremino/"><span class="gid5">spremino</span></a></li>
				<li class="usertitle"><span class="thegroup">Member</span></li>
							</ul>
			<ul class="userinfos">
								<li class="reputation zero">Reputation: 0</li>
						
			    				<li>Registered: 03-Jul-2009</li>
								<li>Posts: 186</li>
							</ul>		
					</div>
	
		<div class="postcontent">
			<div class="postinfo">
			    <span class="conl"><a href="https://forum.colemak.com/post/6421/#p6421">23-Apr-2010 16:10:21</a></span><span class="conr">#2</span>
			    <span class="small-topictitle">Re: &#039;hacked&#039; MSKLC to enable remapping CAPSLOCK</span>
			</div>
			<div class="postmsg">
				<p>Remapping modifier keys without editing the registry? Screaminglemon, you are our hero!</p><p>Now, who does remember these famous last words:</p><p><em>For what its worth, what you want does not actually appear to be possible within the definitions in kbd.h that MSKLC depends on. Only a key remapper (which is essentially a hardware solution) can work around this issue; it is not something that can be done by simply changing VK mappings. </em> (<a href="https://blogs.msdn.com/michkap/archive/2006/11/28/1170048.aspx" rel="nofollow">https://blogs.msdn.com/michkap/archive/ … 70048.aspx</a>)</p>
						
								<div class="boxedit"><span class="info">Last edited by spremino (23-Apr-2010 16:13:30)</span>
				    				</div>
										
							</div>
						<div class="postsign"><p>Dvorak typist here.&#160; Please take my comments with a grain of salt.</p></div>
					</div>		
	</div>
	<div class="post-foot">
		<div class="postfootleft"><span class="offline">Offline</span></div>	
				<div class="postfootright">
			<ul class="postactions">	
								<li class="postrep">
					<span  id="post_rep_6421" class="reputation zero">
						<span class="title">0</span>											</span>
				</li>
							</ul>
		</div>			
				
	</div>
</div>
<div id="p6422" class="block bpost rowodd">
	<div class="post-body">
		<div class="postprofile">	    
						<span class="postavatar offline"><span class="image status offline"><img src="https://forum.colemak.com/assets/images/avatars/1.jpg?m=1453462472" width="150" height="150" alt="" /></span></span>
				
			<ul class="usercard">
			    <li class="username"><a href="https://forum.colemak.com/user/605-screaminglemon/"><span class="gid5">screaminglemon</span></a></li>
				<li class="usertitle"><span class="thegroup">Member</span></li>
							</ul>
			<ul class="userinfos">
								<li class="reputation positive">Reputation: 1</li>
						
			    				<li>Registered: 15-Feb-2010</li>
								<li>Posts: 14</li>
							</ul>		
						<ul class="usercontact">
								<li class="website"><a href="http://www.tinkerwithabandon.com/twa/keyboarding.html" rel="nofollow">Website</a></li>
							</ul>
		    		</div>
	
		<div class="postcontent">
			<div class="postinfo">
			    <span class="conl"><a href="https://forum.colemak.com/post/6422/#p6422">23-Apr-2010 20:48:53</a></span><span class="conr">#3</span>
			    <span class="small-topictitle">Re: &#039;hacked&#039; MSKLC to enable remapping CAPSLOCK</span>
			</div>
			<div class="postmsg">
				<p>Funny.&#160; That was the exact post that led me to this discovery.&#160; So thanks to everyone that pestered Micheal Kaplan on his blog for so long that he finally let that hint slip out.</p><p>I thought I should mention that the testing function internal to MSKLC will not represent any changes you make to the modifier keys but the layouts will validate fine and the .DLL files do definitely work.</p>
						
								<div class="boxedit"><span class="info">Last edited by screaminglemon (23-Apr-2010 20:51:20)</span>
				    				</div>
										
							</div>
						<div class="postsign"><p><a href="http://www.tinkerwithabandon.com/twa/keyboarding.html" rel="nofollow">http://www.tinkerwithabandon.com/twa/keyboarding.html</a></p></div>
					</div>		
	</div>
	<div class="post-foot">
		<div class="postfootleft"><span class="offline">Offline</span></div>	
				<div class="postfootright">
			<ul class="postactions">	
								<li class="postrep">
					<span  id="post_rep_6422" class="reputation zero">
						<span class="title">0</span>											</span>
				</li>
							</ul>
		</div>			
				
	</div>
</div>
<div id="p6456" class="block bpost roweven">
	<div class="post-body">
		<div class="postprofile">	    
						<span class="postavatar offline"><span class="image status offline"><img src="https://forum.colemak.com/assets/images/avatars/1.jpg?m=1453462472" width="150" height="150" alt="" /></span></span>
				
			<ul class="usercard">
			    <li class="username"><a href="https://forum.colemak.com/user/497-spremino/"><span class="gid5">spremino</span></a></li>
				<li class="usertitle"><span class="thegroup">Member</span></li>
							</ul>
			<ul class="userinfos">
								<li class="reputation zero">Reputation: 0</li>
						
			    				<li>Registered: 03-Jul-2009</li>
								<li>Posts: 186</li>
							</ul>		
					</div>
	
		<div class="postcontent">
			<div class="postinfo">
			    <span class="conl"><a href="https://forum.colemak.com/post/6456/#p6456">30-Apr-2010 13:12:19</a></span><span class="conr">#4</span>
			    <span class="small-topictitle">Re: &#039;hacked&#039; MSKLC to enable remapping CAPSLOCK</span>
			</div>
			<div class="postmsg">
				<p>Has anyone a clue about remapping Alt? Its key and related key code are missing.</p><p>Thanks.</p>
						
										
							</div>
						<div class="postsign"><p>Dvorak typist here.&#160; Please take my comments with a grain of salt.</p></div>
					</div>		
	</div>
	<div class="post-foot">
		<div class="postfootleft"><span class="offline">Offline</span></div>	
				<div class="postfootright">
			<ul class="postactions">	
								<li class="postrep">
					<span  id="post_rep_6456" class="reputation zero">
						<span class="title">0</span>											</span>
				</li>
							</ul>
		</div>			
				
	</div>
</div>
<div id="p6457" class="block bpost rowodd">
	<div class="post-body">
		<div class="postprofile">	    
						<span class="postavatar offline"><span class="image status offline"><img src="https://forum.colemak.com/assets/images/avatars/1.jpg?m=1453462472" width="150" height="150" alt="" /></span></span>
				
			<ul class="usercard">
			    <li class="username"><a href="https://forum.colemak.com/user/416-juice43/"><span class="gid5">juice43</span></a></li>
				<li class="usertitle"><span class="thegroup">Member</span></li>
							</ul>
			<ul class="userinfos">
								<li class="reputation zero">Reputation: 0</li>
						
			    				<li>From: New York, New York</li>
								<li>Registered: 22-Nov-2008</li>
								<li>Posts: 85</li>
							</ul>		
					</div>
	
		<div class="postcontent">
			<div class="postinfo">
			    <span class="conl"><a href="https://forum.colemak.com/post/6457/#p6457">02-May-2010 19:02:04</a></span><span class="conr">#5</span>
			    <span class="small-topictitle">Re: &#039;hacked&#039; MSKLC to enable remapping CAPSLOCK</span>
			</div>
			<div class="postmsg">
				<p>I have to say remapping CapsLock to Backspace works perfectly with this. This should be linked on the website or stickied. I&#039;ve been looking for this for a while.</p>
						
										
							</div>
						<div class="postsign"><p>I use ColemakDH. Colemak&#039;s okay though.</p></div>
					</div>		
	</div>
	<div class="post-foot">
		<div class="postfootleft"><span class="offline">Offline</span></div>	
				<div class="postfootright">
			<ul class="postactions">	
								<li class="postrep">
					<span  id="post_rep_6457" class="reputation zero">
						<span class="title">0</span>											</span>
				</li>
							</ul>
		</div>			
				
	</div>
</div>
<div id="p6458" class="block bpost roweven">
	<div class="post-body">
		<div class="postprofile">	    
						<span class="postavatar offline"><span class="image status offline"><img src="https://forum.colemak.com/assets/images/avatars/1.jpg?m=1453462472" width="150" height="150" alt="" /></span></span>
				
			<ul class="usercard">
			    <li class="username"><a href="https://forum.colemak.com/user/605-screaminglemon/"><span class="gid5">screaminglemon</span></a></li>
				<li class="usertitle"><span class="thegroup">Member</span></li>
							</ul>
			<ul class="userinfos">
								<li class="reputation positive">Reputation: 1</li>
						
			    				<li>Registered: 15-Feb-2010</li>
								<li>Posts: 14</li>
							</ul>		
						<ul class="usercontact">
								<li class="website"><a href="http://www.tinkerwithabandon.com/twa/keyboarding.html" rel="nofollow">Website</a></li>
							</ul>
		    		</div>
	
		<div class="postcontent">
			<div class="postinfo">
			    <span class="conl"><a href="https://forum.colemak.com/post/6458/#p6458">03-May-2010 11:02:22</a></span><span class="conr">#6</span>
			    <span class="small-topictitle">Re: &#039;hacked&#039; MSKLC to enable remapping CAPSLOCK</span>
			</div>
			<div class="postmsg">
				<div class="quotebox"><cite>spremino said:</cite><blockquote><div><p>Has anyone a clue about remapping Alt? Its key and related key code are missing.</p><p>Thanks.</p></div></blockquote></div><p>The ALT key is named MENU.&#160; So LALT is </p><div class="codebox"><pre><code>#define T38 _EQ(                           LMENU  )</code></pre></div><p>However, RALT is what is called an escaped scancode. They basically share the same scancode.&#160; It seems that all the escaped scancodes start with #define X...&#160; I&#039;m not sure what would happen if you change one but not the other.&#160; I&#039;m not even sure you can change them at all.&#160; It&#039;s worthy of some experimentation.</p>
						
										
							</div>
						<div class="postsign"><p><a href="http://www.tinkerwithabandon.com/twa/keyboarding.html" rel="nofollow">http://www.tinkerwithabandon.com/twa/keyboarding.html</a></p></div>
					</div>		
	</div>
	<div class="post-foot">
		<div class="postfootleft"><span class="offline">Offline</span></div>	
				<div class="postfootright">
			<ul class="postactions">	
								<li class="postrep">
					<span  id="post_rep_6458" class="reputation zero">
						<span class="title">0</span>											</span>
				</li>
							</ul>
		</div>			
				
	</div>
</div>
<div id="p6460" class="block bpost rowodd">
	<div class="post-body">
		<div class="postprofile">	    
						<span class="postavatar offline"><span class="image status offline"><img src="https://forum.colemak.com/assets/images/avatars/1.jpg?m=1453462472" width="150" height="150" alt="" /></span></span>
				
			<ul class="usercard">
			    <li class="username"><a href="https://forum.colemak.com/user/497-spremino/"><span class="gid5">spremino</span></a></li>
				<li class="usertitle"><span class="thegroup">Member</span></li>
							</ul>
			<ul class="userinfos">
								<li class="reputation zero">Reputation: 0</li>
						
			    				<li>Registered: 03-Jul-2009</li>
								<li>Posts: 186</li>
							</ul>		
					</div>
	
		<div class="postcontent">
			<div class="postinfo">
			    <span class="conl"><a href="https://forum.colemak.com/post/6460/#p6460">03-May-2010 15:25:18</a></span><span class="conr">#7</span>
			    <span class="small-topictitle">Re: &#039;hacked&#039; MSKLC to enable remapping CAPSLOCK</span>
			</div>
			<div class="postmsg">
				<p>I&#039;ve tried switching LCONTROL with LMENU and RCONTROL with RMENU and</p><p>IT WOOOOOOOOOOORKS! ^_^</p><p>Thank you very much, Screaminglemon.</p><p>My final goal is to get rid of RMENU and to have LALT on both sides (I have a customized layout without AltGr), but I&#039;ve not been able to. I&#039;ve tried using either LMENU or MENU in place of RMENU, but that doesn&#039;t accomplish anything. I&#039;ll investigate further.</p><p>EDIT: Tested on Windows XP Professional SP3. Well, I don&#039;t know whether AltGr has been swapped properly with RControl, since I can&#039;t check graphics. I&#039;ll check later.</p>
						
								<div class="boxedit"><span class="info">Last edited by spremino (03-May-2010 15:41:04)</span>
				    				</div>
										
							</div>
						<div class="postsign"><p>Dvorak typist here.&#160; Please take my comments with a grain of salt.</p></div>
					</div>		
	</div>
	<div class="post-foot">
		<div class="postfootleft"><span class="offline">Offline</span></div>	
				<div class="postfootright">
			<ul class="postactions">	
								<li class="postrep">
					<span  id="post_rep_6460" class="reputation zero">
						<span class="title">0</span>											</span>
				</li>
							</ul>
		</div>			
				
	</div>
</div>
<div id="p6470" class="block bpost roweven">
	<div class="post-body">
		<div class="postprofile">	    
						<span class="postavatar offline"><span class="image status offline"><img src="https://forum.colemak.com/assets/images/avatars/1.jpg?m=1453462472" width="150" height="150" alt="" /></span></span>
				
			<ul class="usercard">
			    <li class="username"><a href="https://forum.colemak.com/user/417-gidyn/"><span class="gid5">gidyn</span></a></li>
				<li class="usertitle"><span class="thegroup">Member</span></li>
							</ul>
			<ul class="userinfos">
								<li class="reputation zero">Reputation: 0</li>
						
			    				<li>Registered: 25-Nov-2008</li>
								<li>Posts: 10</li>
							</ul>		
					</div>
	
		<div class="postcontent">
			<div class="postinfo">
			    <span class="conl"><a href="https://forum.colemak.com/post/6470/#p6470">05-May-2010 08:27:40</a></span><span class="conr">#8</span>
			    <span class="small-topictitle">Re: &#039;hacked&#039; MSKLC to enable remapping CAPSLOCK</span>
			</div>
			<div class="postmsg">
				<p>This really ought to be built into the official Windows installer. Shai?</p>
						
										
							</div>
					</div>		
	</div>
	<div class="post-foot">
		<div class="postfootleft"><span class="offline">Offline</span></div>	
				<div class="postfootright">
			<ul class="postactions">	
								<li class="postrep">
					<span  id="post_rep_6470" class="reputation zero">
						<span class="title">0</span>											</span>
				</li>
							</ul>
		</div>			
				
	</div>
</div>
<div id="p6477" class="block bpost rowodd">
	<div class="post-body">
		<div class="postprofile">	    
						<span class="postavatar offline"><span class="image status offline"><img src="https://forum.colemak.com/assets/images/avatars/125.gif?m=1466246725" width="52" height="54" alt="" /></span></span>
				
			<ul class="usercard">
			    <li class="username"><a href="https://forum.colemak.com/user/125-dreymar/"><span class="gid5">DreymaR</span></a></li>
				<li class="usertitle"><span class="thegroup">Member</span></li>
							</ul>
			<ul class="userinfos">
								<li class="reputation positive">Reputation: 26</li>
						
			    				<li>From: Bærum, Norway</li>
								<li>Registered: 13-Dec-2006</li>
								<li>Posts: 3,825</li>
							</ul>		
					</div>
	
		<div class="postcontent">
			<div class="postinfo">
			    <span class="conl"><a href="https://forum.colemak.com/post/6477/#p6477">10-May-2010 14:04:08</a></span><span class="conr">#9</span>
			    <span class="small-topictitle">Re: &#039;hacked&#039; MSKLC to enable remapping CAPSLOCK</span>
			</div>
			<div class="postmsg">
				<p>From what I remember, no key can be defined twice. That&#039;s like defining a C variable twice: You&#039;ll redefine it the second time. So the duplicated modifier keys have separate scan codes (some of them are escaped codes).</p>
						
										
							</div>
						<div class="postsign"><p>*** <a href="http://goo.gl/vVxgSO" rel="nofollow">Learn Colemak in 2–5 steps with Tarmak!</a> ***<br />Check out my <a href="http://goo.gl/IKR3j" rel="nofollow">Big Bag of Keyboard Tricks for XKB (Linux)</a> and <a href="http://goo.gl/ZVmCo" rel="nofollow"> PKL (Win)</a></p></div>
					</div>		
	</div>
	<div class="post-foot">
		<div class="postfootleft"><span class="offline">Offline</span></div>	
				<div class="postfootright">
			<ul class="postactions">	
								<li class="postrep">
					<span  id="post_rep_6477" class="reputation zero">
						<span class="title">0</span>											</span>
				</li>
							</ul>
		</div>			
				
	</div>
</div>
<div id="p6529" class="block bpost roweven">
	<div class="post-body">
		<div class="postprofile">	    
						<span class="postavatar offline"><span class="image status offline"><img src="https://forum.colemak.com/assets/images/avatars/1.jpg?m=1453462472" width="150" height="150" alt="" /></span></span>
				
			<ul class="usercard">
			    <li class="username"><a href="https://forum.colemak.com/user/497-spremino/"><span class="gid5">spremino</span></a></li>
				<li class="usertitle"><span class="thegroup">Member</span></li>
							</ul>
			<ul class="userinfos">
								<li class="reputation zero">Reputation: 0</li>
						
			    				<li>Registered: 03-Jul-2009</li>
								<li>Posts: 186</li>
							</ul>		
					</div>
	
		<div class="postcontent">
			<div class="postinfo">
			    <span class="conl"><a href="https://forum.colemak.com/post/6529/#p6529">09-Jun-2010 17:05:19</a></span><span class="conr">#10</span>
			    <span class="small-topictitle">Re: &#039;hacked&#039; MSKLC to enable remapping CAPSLOCK</span>
			</div>
			<div class="postmsg">
				<p>No luck. I resorted to remapping RAlt to LAlt with AutoHotKey.</p><p>Still, having a one line script I can stop and restart is way better than having a registry hack which requires logging out.</p>
						
										
							</div>
						<div class="postsign"><p>Dvorak typist here.&#160; Please take my comments with a grain of salt.</p></div>
					</div>		
	</div>
	<div class="post-foot">
		<div class="postfootleft"><span class="offline">Offline</span></div>	
				<div class="postfootright">
			<ul class="postactions">	
								<li class="postrep">
					<span  id="post_rep_6529" class="reputation zero">
						<span class="title">0</span>											</span>
				</li>
							</ul>
		</div>			
				
	</div>
</div>
<div id="p6611" class="block bpost rowodd">
	<div class="post-body">
		<div class="postprofile">	    
						<span class="postavatar offline"><span class="image status offline"><img src="https://forum.colemak.com/assets/images/avatars/1.jpg?m=1453462472" width="150" height="150" alt="" /></span></span>
				
			<ul class="usercard">
			    <li class="username"><a href="https://forum.colemak.com/user/713-anders/"><span class="gid5">anders</span></a></li>
				<li class="usertitle"><span class="thegroup">Member</span></li>
							</ul>
			<ul class="userinfos">
								<li class="reputation zero">Reputation: 0</li>
						
			    				<li>Registered: 12-Jul-2010</li>
								<li>Posts: 18</li>
							</ul>		
					</div>
	
		<div class="postcontent">
			<div class="postinfo">
			    <span class="conl"><a href="https://forum.colemak.com/post/6611/#p6611">23-Jul-2010 03:57:37</a></span><span class="conr">#11</span>
			    <span class="small-topictitle">Re: &#039;hacked&#039; MSKLC to enable remapping CAPSLOCK</span>
			</div>
			<div class="postmsg">
				<p>I tried this, while it does work... when you use the Caps Lock key repeatedly it only registers the backspace every second time.</p>
						
										
							</div>
					</div>		
	</div>
	<div class="post-foot">
		<div class="postfootleft"><span class="offline">Offline</span></div>	
				<div class="postfootright">
			<ul class="postactions">	
								<li class="postrep">
					<span  id="post_rep_6611" class="reputation zero">
						<span class="title">0</span>											</span>
				</li>
							</ul>
		</div>			
				
	</div>
</div>
<div id="p6703" class="block bpost roweven">
	<div class="post-body">
		<div class="postprofile">	    
						<span class="postavatar offline"><span class="image status offline"><img src="https://forum.colemak.com/assets/images/avatars/1.jpg?m=1453462472" width="150" height="150" alt="" /></span></span>
				
			<ul class="usercard">
			    <li class="username"><a href="https://forum.colemak.com/user/765-les/"><span class="gid5">Les</span></a></li>
				<li class="usertitle"><span class="thegroup">Member</span></li>
							</ul>
			<ul class="userinfos">
								<li class="reputation zero">Reputation: 0</li>
						
			    				<li>Registered: 14-Aug-2010</li>
								<li>Posts: 6</li>
							</ul>		
					</div>
	
		<div class="postcontent">
			<div class="postinfo">
			    <span class="conl"><a href="https://forum.colemak.com/post/6703/#p6703">23-Aug-2010 14:00:36</a></span><span class="conr">#12</span>
			    <span class="small-topictitle">Re: &#039;hacked&#039; MSKLC to enable remapping CAPSLOCK</span>
			</div>
			<div class="postmsg">
				<p>Works like a charm (WinXP SP3). </p><p>Thank you so much! I&#039;m going to tell (read:bore) everyone I know about this as it&#039;s great for all key layouts. (Here I am still on Dvorak-by-day...)</p>
						
										
							</div>
					</div>		
	</div>
	<div class="post-foot">
		<div class="postfootleft"><span class="offline">Offline</span></div>	
				<div class="postfootright">
			<ul class="postactions">	
								<li class="postrep">
					<span  id="post_rep_6703" class="reputation zero">
						<span class="title">0</span>											</span>
				</li>
							</ul>
		</div>			
				
	</div>
</div>
<div id="p6726" class="block bpost rowodd">
	<div class="post-body">
		<div class="postprofile">	    
						<span class="postavatar offline"><span class="image status offline"><img src="https://forum.colemak.com/assets/images/avatars/1.jpg?m=1453462472" width="150" height="150" alt="" /></span></span>
				
			<ul class="usercard">
			    <li class="username"><a href="https://forum.colemak.com/user/791-czytacz/"><span class="gid5">czytacz</span></a></li>
				<li class="usertitle"><span class="thegroup">New member</span></li>
							</ul>
			<ul class="userinfos">
								<li class="reputation zero">Reputation: 0</li>
						
			    				<li>Registered: 28-Aug-2010</li>
								<li>Posts: 2</li>
							</ul>		
					</div>
	
		<div class="postcontent">
			<div class="postinfo">
			    <span class="conl"><a href="https://forum.colemak.com/post/6726/#p6726">28-Aug-2010 18:58:54</a></span><span class="conr">#13</span>
			    <span class="small-topictitle">Re: &#039;hacked&#039; MSKLC to enable remapping CAPSLOCK</span>
			</div>
			<div class="postmsg">
				<p>Maybe I absolutely did not understand what this discussion is about. If it really is about getting &#039;normal&#039; CAPSLOCK behaviour after having remapped your keyboard, then there is no problem. MSKLC allows to regulate the CAPSLOCK behaviour for every key separately. Click a key in MSKLC, e.g. VK_OEM_7 (which in the QUERTY keyboard contains quotation marks). A small screen appears that allows to assign a character of your choice to that key, but not only that. Click the button &quot;All…&quot; (&#039;Shows all shift states for this key&#039;) in the small screen that appears and check or uncheck &#039;caps = shift&#039; according to what is needed. That&#039;s all.</p>
						
										
							</div>
					</div>		
	</div>
	<div class="post-foot">
		<div class="postfootleft"><span class="offline">Offline</span></div>	
				<div class="postfootright">
			<ul class="postactions">	
								<li class="postrep">
					<span  id="post_rep_6726" class="reputation zero">
						<span class="title">0</span>											</span>
				</li>
							</ul>
		</div>			
				
	</div>
</div>
<div id="p6727" class="block bpost roweven">
	<div class="post-body">
		<div class="postprofile">	    
						<span class="postavatar offline"><span class="image status offline"><img src="https://forum.colemak.com/assets/images/avatars/1.jpg?m=1453462472" width="150" height="150" alt="" /></span></span>
				
			<ul class="usercard">
			    <li class="username"><a href="https://forum.colemak.com/user/497-spremino/"><span class="gid5">spremino</span></a></li>
				<li class="usertitle"><span class="thegroup">Member</span></li>
							</ul>
			<ul class="userinfos">
								<li class="reputation zero">Reputation: 0</li>
						
			    				<li>Registered: 03-Jul-2009</li>
								<li>Posts: 186</li>
							</ul>		
					</div>
	
		<div class="postcontent">
			<div class="postinfo">
			    <span class="conl"><a href="https://forum.colemak.com/post/6727/#p6727">30-Aug-2010 08:35:11</a></span><span class="conr">#14</span>
			    <span class="small-topictitle">Re: &#039;hacked&#039; MSKLC to enable remapping CAPSLOCK</span>
			</div>
			<div class="postmsg">
				<p>Hi czytacz, this discussion is about using the Caps Lock key for some other function (Backspace, etc.), not about just disabling it. Thank you for your tip, however ^_^</p>
						
										
							</div>
						<div class="postsign"><p>Dvorak typist here.&#160; Please take my comments with a grain of salt.</p></div>
					</div>		
	</div>
	<div class="post-foot">
		<div class="postfootleft"><span class="offline">Offline</span></div>	
				<div class="postfootright">
			<ul class="postactions">	
								<li class="postrep">
					<span  id="post_rep_6727" class="reputation zero">
						<span class="title">0</span>											</span>
				</li>
							</ul>
		</div>			
				
	</div>
</div>
<div id="p6728" class="block bpost rowodd">
	<div class="post-body">
		<div class="postprofile">	    
						<span class="postavatar offline"><span class="image status offline"><img src="https://forum.colemak.com/assets/images/avatars/1.jpg?m=1453462472" width="150" height="150" alt="" /></span></span>
				
			<ul class="usercard">
			    <li class="username"><a href="https://forum.colemak.com/user/791-czytacz/"><span class="gid5">czytacz</span></a></li>
				<li class="usertitle"><span class="thegroup">New member</span></li>
							</ul>
			<ul class="userinfos">
								<li class="reputation zero">Reputation: 0</li>
						
			    				<li>Registered: 28-Aug-2010</li>
								<li>Posts: 2</li>
							</ul>		
					</div>
	
		<div class="postcontent">
			<div class="postinfo">
			    <span class="conl"><a href="https://forum.colemak.com/post/6728/#p6728">30-Aug-2010 11:00:09</a></span><span class="conr">#15</span>
			    <span class="small-topictitle">Re: &#039;hacked&#039; MSKLC to enable remapping CAPSLOCK</span>
			</div>
			<div class="postmsg">
				<p>Hello, Spremino. Now I wonder why the use of the CapsLock key for some other function like Backspace could not be arranged more easily by a program like KeyTweak. At least that is what I used for mapping the CapsLock function onto the RightCtrl key and using the CapsLock key for some other function (not Backspace in my case). Of course this may well be just another irrelevant suggestion, for changes brought about by KeyTweak (or any similar program) are not limited to only one specific keyboard but to all keyboard. I just wanted to get rid of the effect of inadvertantly touching the CapsLock key while typing an A, so I was happy to have something less obnoxious next to the A key.</p>
						
								<div class="boxedit"><span class="info">Last edited by czytacz (30-Aug-2010 11:13:32)</span>
				    				</div>
										
							</div>
					</div>		
	</div>
	<div class="post-foot">
		<div class="postfootleft"><span class="offline">Offline</span></div>	
				<div class="postfootright">
			<ul class="postactions">	
								<li class="postrep">
					<span  id="post_rep_6728" class="reputation zero">
						<span class="title">0</span>											</span>
				</li>
							</ul>
		</div>			
				
	</div>
</div>
<div id="p6729" class="block bpost roweven">
	<div class="post-body">
		<div class="postprofile">	    
						<span class="postavatar offline"><span class="image status offline"><img src="https://forum.colemak.com/assets/images/avatars/1.jpg?m=1453462472" width="150" height="150" alt="" /></span></span>
				
			<ul class="usercard">
			    <li class="username"><a href="https://forum.colemak.com/user/497-spremino/"><span class="gid5">spremino</span></a></li>
				<li class="usertitle"><span class="thegroup">Member</span></li>
							</ul>
			<ul class="userinfos">
								<li class="reputation zero">Reputation: 0</li>
						
			    				<li>Registered: 03-Jul-2009</li>
								<li>Posts: 186</li>
							</ul>		
					</div>
	
		<div class="postcontent">
			<div class="postinfo">
			    <span class="conl"><a href="https://forum.colemak.com/post/6729/#p6729">30-Aug-2010 11:38:28</a></span><span class="conr">#16</span>
			    <span class="small-topictitle">Re: &#039;hacked&#039; MSKLC to enable remapping CAPSLOCK</span>
			</div>
			<div class="postmsg">
				<div class="quotebox"><cite>czytacz said:</cite><blockquote><div><p>Hello, Spremino. Now I wonder why the use of the CapsLock key for some other function like Backspace could not be arranged more easily by a program like KeyTweak.</p></div></blockquote></div><p>Therefore to install Colemak you&#039;d need both a layout setup and KeyTweak. Moreover, whenever you would like to switch back to standard Qwerty (Caps Lock included), you would have to use both the Control Panel applet and KeyTweak. OTOH, a tweaked MSKLC layout will not require any other software and you&#039;ll just need the Control Panel applet to switch. To me, this is the most convenient way.</p>
						
								<div class="boxedit"><span class="info">Last edited by spremino (30-Aug-2010 12:41:20)</span>
				    				</div>
										
							</div>
						<div class="postsign"><p>Dvorak typist here.&#160; Please take my comments with a grain of salt.</p></div>
					</div>		
	</div>
	<div class="post-foot">
		<div class="postfootleft"><span class="offline">Offline</span></div>	
				<div class="postfootright">
			<ul class="postactions">	
								<li class="postrep">
					<span  id="post_rep_6729" class="reputation zero">
						<span class="title">0</span>											</span>
				</li>
							</ul>
		</div>			
				
	</div>
</div>
<div id="p6996" class="block bpost rowodd">
	<div class="post-body">
		<div class="postprofile">	    
						<span class="postavatar offline"><span class="image status offline"><img src="https://forum.colemak.com/assets/images/avatars/1.jpg?m=1453462472" width="150" height="150" alt="" /></span></span>
				
			<ul class="usercard">
			    <li class="username"><a href="https://forum.colemak.com/user/878-culinia/"><span class="gid5">Culinia</span></a></li>
				<li class="usertitle"><span class="thegroup">Member</span></li>
							</ul>
			<ul class="userinfos">
								<li class="reputation zero">Reputation: 0</li>
						
			    				<li>Registered: 07-Oct-2010</li>
								<li>Posts: 28</li>
							</ul>		
					</div>
	
		<div class="postcontent">
			<div class="postinfo">
			    <span class="conl"><a href="https://forum.colemak.com/post/6996/#p6996">21-Nov-2010 00:22:20</a></span><span class="conr">#17</span>
			    <span class="small-topictitle">Re: &#039;hacked&#039; MSKLC to enable remapping CAPSLOCK</span>
			</div>
			<div class="postmsg">
				<p>Lol what the?</p><p>&quot;Access denied&quot;</p><p>- when I try and overwrite the existing file :(</p><p>edit: no worries.</p><p>-- for those on windows 7 and I suppose vista you need to make and save changes outside the program files IF you have UAC turned on.</p>
						
								<div class="boxedit"><span class="info">Last edited by Culinia (21-Nov-2010 00:24:32)</span>
				    				</div>
										
							</div>
					</div>		
	</div>
	<div class="post-foot">
		<div class="postfootleft"><span class="offline">Offline</span></div>	
				<div class="postfootright">
			<ul class="postactions">	
								<li class="postrep">
					<span  id="post_rep_6996" class="reputation zero">
						<span class="title">0</span>											</span>
				</li>
							</ul>
		</div>			
				
	</div>
</div>
<div id="p7817" class="block bpost roweven">
	<div class="post-body">
		<div class="postprofile">	    
						<span class="postavatar offline"><span class="image status offline"><img src="https://forum.colemak.com/assets/images/avatars/1.jpg?m=1453462472" width="150" height="150" alt="" /></span></span>
				
			<ul class="usercard">
			    <li class="username"><a href="https://forum.colemak.com/user/1522-michkap/"><span class="gid5">michkap</span></a></li>
				<li class="usertitle"><span class="thegroup">New member</span></li>
							</ul>
			<ul class="userinfos">
								<li class="reputation zero">Reputation: 0</li>
						
			    				<li>Registered: 10-Apr-2011</li>
								<li>Posts: 1</li>
							</ul>		
					</div>
	
		<div class="postcontent">
			<div class="postinfo">
			    <span class="conl"><a href="https://forum.colemak.com/post/7817/#p7817">10-Apr-2011 07:38:52</a></span><span class="conr">#18</span>
			    <span class="small-topictitle">Re: &#039;hacked&#039; MSKLC to enable remapping CAPSLOCK</span>
			</div>
			<div class="postmsg">
				<p>FYI, my thoughts on this (and info on both some of the reported problems and some of the inherent issues in the approach) can be found here:</p><p><a href="http://www.siao2.com/2011/04/09/10151666.aspx" rel="nofollow">http://www.siao2.com/2011/04/09/10151666.aspx</a></p><p>Cheers,<br />Michael</p>
						
										
							</div>
					</div>		
	</div>
	<div class="post-foot">
		<div class="postfootleft"><span class="offline">Offline</span></div>	
				<div class="postfootright">
			<ul class="postactions">	
								<li class="postrep">
					<span  id="post_rep_7817" class="reputation zero">
						<span class="title">0</span>											</span>
				</li>
							</ul>
		</div>			
				
	</div>
</div>
<div id="p11103" class="block bpost rowodd">
	<div class="post-body">
		<div class="postprofile">	    
						<span class="postavatar offline"><span class="image status offline"><img src="https://forum.colemak.com/assets/images/avatars/1.jpg?m=1453462472" width="150" height="150" alt="" /></span></span>
				
			<ul class="usercard">
			    <li class="username"><a href="https://forum.colemak.com/user/2140-datiskh/"><span class="gid5">datiskh</span></a></li>
				<li class="usertitle"><span class="thegroup">New member</span></li>
							</ul>
			<ul class="userinfos">
								<li class="reputation zero">Reputation: 0</li>
						
			    				<li>Registered: 21-Dec-2012</li>
								<li>Posts: 1</li>
							</ul>		
					</div>
	
		<div class="postcontent">
			<div class="postinfo">
			    <span class="conl"><a href="https://forum.colemak.com/post/11103/#p11103">21-Dec-2012 02:32:28</a></span><span class="conr">#19</span>
			    <span class="small-topictitle">Re: &#039;hacked&#039; MSKLC to enable remapping CAPSLOCK</span>
			</div>
			<div class="postmsg">
				<p>Hello<br />I surprised to find this post because I engage of a very teasing proplem in MSKLC. that is simple: I want to add virtual space in Shift + Space combination. but validation error occur and log it:<br />&quot;ERROR: &#039;VK_SPACE&#039; in Shift State &#039;Shift&#039; must be made up of white space character(s), but is defined as &#039;&#039; (U+200c) instead.&quot;<br />this is in the case which I imported even a ready installed keyboard in MSKLC and even without any change, right after importing the keyboard, and run Make DLL, the above mentioned Error occur. PLEASE help me if you know how can I ignore the error and create my own keyboard. when others could do it and embed (U+200c) in their keyboards, this should be possible for me.... how can I hack the error for such code for Shift + space? I really need your help<br />All the Best<br />Datis</p>
						
										
							</div>
					</div>		
	</div>
	<div class="post-foot">
		<div class="postfootleft"><span class="offline">Offline</span></div>	
				<div class="postfootright">
			<ul class="postactions">	
								<li class="postrep">
					<span  id="post_rep_11103" class="reputation zero">
						<span class="title">0</span>											</span>
				</li>
							</ul>
		</div>			
				
	</div>
</div>
<div id="p16028" class="block bpost roweven">
	<div class="post-body">
		<div class="postprofile">	    
						<span class="postavatar offline"><span class="image status offline"><img src="https://forum.colemak.com/assets/images/avatars/1.jpg?m=1453462472" width="150" height="150" alt="" /></span></span>
				
			<ul class="usercard">
			    <li class="username"><a href="https://forum.colemak.com/user/497-spremino/"><span class="gid5">spremino</span></a></li>
				<li class="usertitle"><span class="thegroup">Member</span></li>
							</ul>
			<ul class="userinfos">
								<li class="reputation zero">Reputation: 0</li>
						
			    				<li>Registered: 03-Jul-2009</li>
								<li>Posts: 186</li>
							</ul>		
					</div>
	
		<div class="postcontent">
			<div class="postinfo">
			    <span class="conl"><a href="https://forum.colemak.com/post/16028/#p16028">06-Dec-2014 23:33:40</a></span><span class="conr">#20</span>
			    <span class="small-topictitle">Re: &#039;hacked&#039; MSKLC to enable remapping CAPSLOCK</span>
			</div>
			<div class="postmsg">
				<p>Does anybody know whether this hack still works on Windows 8.1?</p>
						
										
							</div>
						<div class="postsign"><p>Dvorak typist here.&#160; Please take my comments with a grain of salt.</p></div>
					</div>		
	</div>
	<div class="post-foot">
		<div class="postfootleft"><span class="offline">Offline</span></div>	
				<div class="postfootright">
			<ul class="postactions">	
								<li class="postrep">
					<span  id="post_rep_16028" class="reputation zero">
						<span class="title">0</span>											</span>
				</li>
							</ul>
		</div>			
				
	</div>
</div>
<div id="p16816" class="block bpost rowodd">
	<div class="post-body">
		<div class="postprofile">	    
						<span class="postavatar offline"><span class="image status offline"><img src="https://forum.colemak.com/assets/images/avatars/1.jpg?m=1453462472" width="150" height="150" alt="" /></span></span>
				
			<ul class="usercard">
			    <li class="username"><a href="https://forum.colemak.com/user/2561-drghobar/"><span class="gid5">Dr.Ghobar</span></a></li>
				<li class="usertitle"><span class="thegroup">New member</span></li>
							</ul>
			<ul class="userinfos">
								<li class="reputation zero">Reputation: 0</li>
						
			    				<li>Registered: 28-May-2015</li>
								<li>Posts: 1</li>
							</ul>		
					</div>
	
		<div class="postcontent">
			<div class="postinfo">
			    <span class="conl"><a href="https://forum.colemak.com/post/16816/#p16816">28-May-2015 14:22:21</a></span><span class="conr">#21</span>
			    <span class="small-topictitle">Re: &#039;hacked&#039; MSKLC to enable remapping CAPSLOCK</span>
			</div>
			<div class="postmsg">
				<p>Hello<br />How should MSKLC be hacked or changed to allow assigning U+200c to Shift+Space?</p>
						
										
							</div>
					</div>		
	</div>
	<div class="post-foot">
		<div class="postfootleft"><span class="offline">Offline</span></div>	
				<div class="postfootright">
			<ul class="postactions">	
								<li class="postrep">
					<span  id="post_rep_16816" class="reputation zero">
						<span class="title">0</span>											</span>
				</li>
							</ul>
		</div>			
				
	</div>
</div>
<div id="p19637" class="block bpost roweven">
	<div class="post-body">
		<div class="postprofile">	    
						<span class="postavatar offline"><span class="image status offline"><img src="https://forum.colemak.com/assets/images/avatars/1.jpg?m=1453462472" width="150" height="150" alt="" /></span></span>
				
			<ul class="usercard">
			    <li class="username"><a href="https://forum.colemak.com/user/2806-tmn/"><span class="gid6">tmn</span></a></li>
				<li class="usertitle"><span class="thegroup">New member</span></li>
							</ul>
			<ul class="userinfos">
								<li class="reputation zero">Reputation: 0</li>
						
			    				<li>Registered: 17-Apr-2017</li>
								<li>Posts: 2</li>
							</ul>		
					</div>
	
		<div class="postcontent">
			<div class="postinfo">
			    <span class="conl"><a href="https://forum.colemak.com/post/19637/#p19637">17-Apr-2017 16:17:19</a></span><span class="conr">#22</span>
			    <span class="small-topictitle">Re: &#039;hacked&#039; MSKLC to enable remapping CAPSLOCK</span>
			</div>
			<div class="postmsg">
				<p>Keep in mind that MSKLC layouts might break shortcuts in some applications. It happens with Ctrl-Shift-letter and some other combinations, as described <a href="http://search.cpan.org/~ilyaz/UI-KeyboardLayout-0.71/lib/UI/KeyboardLayout.pm#MSKLC_keyboards_handle_Ctrl-Shift-letter,_Ctrl-@_(x00)_,_Ctrl-^_(x1e)_and_Ctrl-__(x1f)_differently_than_US_keyboard" rel="nofollow">here</a>.</p><p>For example, Civilization 3 was affected by this, and, I think, Firefox had the same problem.</p><p>Layouts created with KbdEdit work fine, but that program isn&#039;t free.</p>
						
										
							</div>
					</div>		
	</div>
	<div class="post-foot">
		<div class="postfootleft"><span class="offline">Offline</span></div>	
				<div class="postfootright">
			<ul class="postactions">	
								<li class="postrep">
					<span  id="post_rep_19637" class="reputation zero">
						<span class="title">0</span>											</span>
				</li>
							</ul>
		</div>			
				
	</div>
</div>
<div id="p19646" class="block bpost rowodd">
	<div class="post-body">
		<div class="postprofile">	    
						<span class="postavatar offline"><span class="image status offline"><img src="https://forum.colemak.com/assets/images/avatars/125.gif?m=1466246725" width="52" height="54" alt="" /></span></span>
				
			<ul class="usercard">
			    <li class="username"><a href="https://forum.colemak.com/user/125-dreymar/"><span class="gid5">DreymaR</span></a></li>
				<li class="usertitle"><span class="thegroup">Member</span></li>
							</ul>
			<ul class="userinfos">
								<li class="reputation positive">Reputation: 26</li>
						
			    				<li>From: Bærum, Norway</li>
								<li>Registered: 13-Dec-2006</li>
								<li>Posts: 3,825</li>
							</ul>		
					</div>
	
		<div class="postcontent">
			<div class="postinfo">
			    <span class="conl"><a href="https://forum.colemak.com/post/19646/#p19646">19-Apr-2017 12:35:50</a></span><span class="conr">#23</span>
			    <span class="small-topictitle">Re: &#039;hacked&#039; MSKLC to enable remapping CAPSLOCK</span>
			</div>
			<div class="postmsg">
				<p>Interesting, <a href="https://forum.colemak.com/user/2806-tmn/"><span class="gid6">tmn</span></a>. And a bit complex. Have you got any experience with UI:KeyboardLayout tool from the page you linked to?</p>
						
								<div class="boxedit"><span class="info">Last edited by DreymaR (19-Apr-2017 12:36:14)</span>
				    				</div>
										
							</div>
						<div class="postsign"><p>*** <a href="http://goo.gl/vVxgSO" rel="nofollow">Learn Colemak in 2–5 steps with Tarmak!</a> ***<br />Check out my <a href="http://goo.gl/IKR3j" rel="nofollow">Big Bag of Keyboard Tricks for XKB (Linux)</a> and <a href="http://goo.gl/ZVmCo" rel="nofollow"> PKL (Win)</a></p></div>
					</div>		
	</div>
	<div class="post-foot">
		<div class="postfootleft"><span class="offline">Offline</span></div>	
				<div class="postfootright">
			<ul class="postactions">	
								<li class="postrep">
					<span  id="post_rep_19646" class="reputation zero">
						<span class="title">0</span>											</span>
				</li>
							</ul>
		</div>			
				
	</div>
</div>
<div id="p19659" class="block bpost roweven">
	<div class="post-body">
		<div class="postprofile">	    
						<span class="postavatar offline"><span class="image status offline"><img src="https://forum.colemak.com/assets/images/avatars/1.jpg?m=1453462472" width="150" height="150" alt="" /></span></span>
				
			<ul class="usercard">
			    <li class="username"><a href="https://forum.colemak.com/user/2806-tmn/"><span class="gid6">tmn</span></a></li>
				<li class="usertitle"><span class="thegroup">New member</span></li>
							</ul>
			<ul class="userinfos">
								<li class="reputation zero">Reputation: 0</li>
						
			    				<li>Registered: 17-Apr-2017</li>
								<li>Posts: 2</li>
							</ul>		
					</div>
	
		<div class="postcontent">
			<div class="postinfo">
			    <span class="conl"><a href="https://forum.colemak.com/post/19659/#p19659">20-Apr-2017 18:47:22</a></span><span class="conr">#24</span>
			    <span class="small-topictitle">Re: &#039;hacked&#039; MSKLC to enable remapping CAPSLOCK</span>
			</div>
			<div class="postmsg">
				<p>No, I haven&#039;t used the module itself. But its documentation was of great help. That module is designed to produce the <a href="https://math.berkeley.edu/~serganov/ilyaz.org/keyboard/" rel="nofollow">izKeys</a> crazy layouts.</p><p>I&#039;ve just tried to import US layout into MSKLC, save it into .klc file and then compare &quot;kbdutool -s&quot; output to a publicly available US layout <a href="https://github.com/Microsoft/Windows-driver-samples/blob/master/input/layout/kbdus/kbdus.c" rel="nofollow">source</a> (kbdutool comes with MSKLC). And the reason for the mentioned bug becomes clear.</p><p>Edited:<br />On import MSKLC loses three Ctrl+Shift combinations. From the original US layout:</p><div class="codebox"><pre><code>static ALLOC_SECTION_LDATA VK_TO_WCHARS4 aVkToWch4[] = {
//                      |         |  Shift  |  Ctrl   |S+Ctrl   |
//                      |=========|=========|=========|=========|
  {&#039;2&#039;          ,0      ,&#039;2&#039;      ,&#039;@&#039;      ,WCH_NONE ,0x0000   },
  {&#039;6&#039;          ,0      ,&#039;6&#039;      ,&#039;^&#039;      ,WCH_NONE ,0x001e   },
  {VK_OEM_MINUS ,0      ,&#039;-&#039;      ,&#039;_&#039;      ,WCH_NONE ,0x001f   },</code></pre></div><p>Adding them back produces a warning: </p><div class="quotebox"><blockquote><div><p>WARNING: The &lt;Shift+Control&gt; shift state for VK_2 contains a control character. This is redundant and should be removed.</p></div></blockquote></div><p>I don&#039;t know what&#039;s the story behind it, but other characters bound to Ctrl+Shift in other layouts import fine.</p><p>However, with no Ctrl+Shift combinations left MSKLC does not add Ctrl+Shift as a handled state into SHIFTSTATE section of .klc file. Which, in turn, causes different behavior after compilation.</p><p>I&#039;ve found two ways to fix this: <br />- add any Ctrl+Shift+... combination in MSKLC and rebuild from the menu;<br />- or change the relevant section inside the .klc file</p><div class="codebox"><pre><code>SHIFTSTATE

0	//Column 4
1	//Column 5 : Shft
2	//Column 6 :       Ctrl
3	//Column 7 : Shft  Ctrl</code></pre></div><p>and recompile with kbdutool.</p><p>Another difference from kbdus.c was that kbdutool put all the keys into the widest array.<br />kbdus.c:</p><div class="codebox"><pre><code>static ALLOC_SECTION_LDATA VK_TO_WCHARS2 aVkToWch2[] = {
//                      |         |  Shift  |
//                      |=========|=========|
  {VK_OEM_3     ,0      ,&#039;`&#039;      ,&#039;~&#039;      },</code></pre></div><p>kbdutool:</p><div class="codebox"><pre><code>static ALLOC_SECTION_LDATA VK_TO_WCHARS3 aVkToWch3[] = {
//                      |         |  Shift  |  Ctrl   |
//                      |=========|=========|=========|
  {VK_OEM_3     ,0      ,&#039;`&#039;      ,&#039;~&#039;      ,WCH_NONE },</code></pre></div><p>I don&#039;t think it affects anything. But the same structure can be achieved with kbdutool, if the trailing &quot;-1&quot;s are removed from the .klc file.</p><p>Is there any other tool to convert a .dll layout back into C source? Or anything else that can produce standalone layouts like MSKLC and KbdEdit?</p>
						
								<div class="boxedit"><span class="info">Last edited by tmn (20-Apr-2017 22:21:50)</span>
				    				</div>
										
							</div>
					</div>		
	</div>
	<div class="post-foot">
		<div class="postfootleft"><span class="offline">Offline</span></div>	
				<div class="postfootright">
			<ul class="postactions">	
								<li class="postrep">
					<span  id="post_rep_19659" class="reputation zero">
						<span class="title">0</span>											</span>
				</li>
							</ul>
		</div>			
				
	</div>
</div>
<div id="p19664" class="block bpost rowodd">
	<div class="post-body">
		<div class="postprofile">	    
						<span class="postavatar offline"><span class="image status offline"><img src="https://forum.colemak.com/assets/images/avatars/125.gif?m=1466246725" width="52" height="54" alt="" /></span></span>
				
			<ul class="usercard">
			    <li class="username"><a href="https://forum.colemak.com/user/125-dreymar/"><span class="gid5">DreymaR</span></a></li>
				<li class="usertitle"><span class="thegroup">Member</span></li>
							</ul>
			<ul class="userinfos">
								<li class="reputation positive">Reputation: 26</li>
						
			    				<li>From: Bærum, Norway</li>
								<li>Registered: 13-Dec-2006</li>
								<li>Posts: 3,825</li>
							</ul>		
					</div>
	
		<div class="postcontent">
			<div class="postinfo">
			    <span class="conl"><a href="https://forum.colemak.com/post/19664/#p19664">21-Apr-2017 13:09:31</a></span><span class="conr">#25</span>
			    <span class="small-topictitle">Re: &#039;hacked&#039; MSKLC to enable remapping CAPSLOCK</span>
			</div>
			<div class="postmsg">
				<p>I know of no such tools. I&#039;ve never even used kbdutool directly, although I&#039;ve wanted to on some occasions.</p><p>Surely, the extra Ctrl column shouldn&#039;t matter as long as there&#039;s WCH_NONE in it. Looks like it&#039;s just accounting for the extra Ctrl state but not adding anything to it.</p>
						
										
							</div>
						<div class="postsign"><p>*** <a href="http://goo.gl/vVxgSO" rel="nofollow">Learn Colemak in 2–5 steps with Tarmak!</a> ***<br />Check out my <a href="http://goo.gl/IKR3j" rel="nofollow">Big Bag of Keyboard Tricks for XKB (Linux)</a> and <a href="http://goo.gl/ZVmCo" rel="nofollow"> PKL (Win)</a></p></div>
					</div>		
	</div>
	<div class="post-foot">
		<div class="postfootleft"><span class="offline">Offline</span></div>	
				<div class="postfootright">
			<ul class="postactions">	
								<li class="postrep">
					<span  id="post_rep_19664" class="reputation zero">
						<span class="title">0</span>											</span>
				</li>
							</ul>
		</div>			
				
	</div>
</div>



<div class="linksb">
	<div class="pagepost">
		<ul class="pagination"></ul>
		<div class="postlink">
		    		    		    		    		    		</div>
	</div>	
    <ul vocab="http://schema.org/" typeof="BreadcrumbList" class="crumbs">
		<li property="itemListElement" typeof="ListItem">
			<a property="item" typeof="WebPage" href="https://forum.colemak.com/"><span property="name">Index</span></a>
			<meta property="position" content="1">
		</li>
  
			
		<span class="separator">›</span>
		<li property="itemListElement" typeof="ListItem">
			<a property="item" typeof="WebPage" href="https://forum.colemak.com/forum/10-user-contributions/"><span property="name">User contributions</span></a>
			<meta property="position" content="2">
		</li>
	
		<span class="separator">›</span>
		<li property="itemListElement" typeof="ListItem">
			<span property="item" typeof="WebPage"><span property="name">&#039;hacked&#039; MSKLC to enable remapping CAPSLOCK</span></span>
			<meta property="position" content="3">
		</li>
	</ul>
</div>
</div>
</div> <!-- .brd-admin -->
<footer id="brdfooter" class="brd-footer">
    <div class="wrapper">
	   <div class="box quickjump">
	        <form id="qjump" method="get" action="https://forum.colemak.com/viewforum.php">

<label for="jumpto">Jump to</label>
<select id="jumpto" name="id" onchange="window.location=('https://forum.colemak.com/forum/'+this.options[this.selectedIndex].value)+'-'+this.options[this.selectedIndex].getAttribute('data-name')+'/'">
<optgroup label="Colemak">
<option data-name="experiences" value="6">Experiences</option>
<option data-name="technical" value="3">Technical</option>
<option data-name="user-contributions" value="10" selected="selected">User contributions</option>
<option data-name="general" value="2">General</option>
</optgroup>
</select>
<input type="submit" value="Go" accesskey="g" />
</form>
	    </div>
				
		    </div>
	
        <p class="atom feedlink"><a href="https://forum.colemak.com/feed/atom/tid/870.xml">Atom topic feed</a></p>
    
    
	<p class="powered">Powered by <a href="https://www.pantherforum.org">Panther</a></p>
</footer>

</div><!-- .pantherpage -->
	
</body>
</html>
